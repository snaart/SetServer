# üÉè Set Game Server

–í—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä –¥–ª—è –º–Ω–æ–≥–æ–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π –∫–∞—Ä—Ç–æ—á–Ω–æ–π –∏–≥—Ä—ã **Set**, –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–π –Ω–∞ Python —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **FastAPI**.

–°–µ—Ä–≤–µ—Ä –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ –∏–≥—Ä–æ–≤—ã—Ö –∫–æ–º–Ω–∞—Ç, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –≤–∞–ª–∏–¥–∞—Ü–∏—é —Ö–æ–¥–æ–≤ (–ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ç–æ–≤) –∏ –ø–æ–¥—Å—á–µ—Ç –æ—á–∫–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏. –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∑–∞—â–∏—Ç–∞ –æ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è –≥–æ–Ω–∫–∏ (race conditions) –ø—Ä–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º –≤—ã–±–æ—Ä–µ –∫–∞—Ä—Ç –∏–≥—Ä–æ–∫–∞–º–∏.

## üöÄ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

*   **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `async/await` –¥–ª—è –≤—ã—Å–æ–∫–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.
*   **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø–æ—Ç–æ–∫–æ–≤**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `asyncio.Lock` –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –æ–¥–Ω—É –∏ —Ç—É –∂–µ –∫–∞—Ä—Ç—É –Ω–µ–ª—å–∑—è –∑–∞–±—Ä–∞—Ç—å –¥–≤–∞–∂–¥—ã –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.
*   **–ò–≥—Ä–æ–≤–∞—è –ª–æ–≥–∏–∫–∞**: –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∞–≤–∏–ª –∏–≥—Ä—ã Set (–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–ª–æ–¥—ã 81 –∫–∞—Ä—Ç—ã, –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–º–±–∏–Ω–∞—Ü–∏–π).
*   **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º**: In-memory —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–≥—Ä –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏).
*   **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π Swagger UI.

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

*   **Python 3.8+**
*   **FastAPI** ‚Äî –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫.
*   **Uvicorn** ‚Äî ASGI —Å–µ—Ä–≤–µ—Ä.
*   **Pydantic** ‚Äî –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö.
*   **Pytest & HTTPX** ‚Äî —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ.

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1.  **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π** –∏–ª–∏ —Å–∫–∞—á–∞–π—Ç–µ —Ñ–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞.

2.  **–°–æ–∑–¥–∞–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ** (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):
    ```bash
    python -m venv venv
    # –î–ª—è Windows:
    venv\Scripts\activate
    # –î–ª—è Linux/MacOS:
    source venv/bin/activate
    ```

3.  **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**:
    ```bash
    pip install fastapi uvicorn pydantic pytest httpx
    ```

## ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞

–î–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É:

```bash
python main.py
```
*–ò–ª–∏ —á–µ—Ä–µ–∑ uvicorn –Ω–∞–ø—Ä—è–º—É—é:*
```bash
uvicorn main:app --reload --host 0.0.0.0 --port 8000
```

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: `http://localhost:8000`

### üìÑ API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (Swagger)

FastAPI –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é. –ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ —Å—Å—ã–ª–∫–µ:

üëâ **[http://localhost:8000/docs](http://localhost:8000/docs)**

–ó–¥–µ—Å—å –≤—ã –º–æ–∂–µ—Ç–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –º–µ—Ç–æ–¥—ã API –ø—Ä—è–º–æ –∏–∑ –±—Ä–∞—É–∑–µ—Ä–∞.

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è –Ω–∞–±–æ—Ä –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ (`test_server.py`), –ø—Ä–æ–≤–µ—Ä—è—é—â–∏—Ö –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª –∏–≥—Ä—ã: –æ—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –¥–æ –ø–æ–¥—Å—á–µ—Ç–∞ –æ—á–∫–æ–≤.

–î–ª—è –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
pytest test_server.py -v
```

## üîå –û–ø–∏—Å–∞–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤

–í—Å–µ –∑–∞–ø—Ä–æ—Å—ã (–∫—Ä–æ–º–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏) —Ç—Ä–µ–±—É—é—Ç `accessToken`.

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
*   `POST /user/register` ‚Äî –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è (–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–∫–µ–Ω).

### –ö–æ–º–Ω–∞—Ç—ã (–õ–æ–±–±–∏)
*   `POST /set/room/create` ‚Äî –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∏–≥—Ä—É.
*   `POST /set/room/list` ‚Äî –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∏–≥—Ä.
*   `POST /set/room/enter` ‚Äî –í–æ–π—Ç–∏ –≤ –∫–æ–º–Ω–∞—Ç—É.

### –ò–≥—Ä–æ–≤–æ–π –ø—Ä–æ—Ü–µ—Å—Å
*   `POST /set/field` ‚Äî –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å—Ç–æ–ª–∞ (–∫–∞—Ä—Ç—ã, —Å—Ç–∞—Ç—É—Å, –æ—á–∫–∏).
*   `POST /set/pick` ‚Äî **–ì–ª–∞–≤–Ω—ã–π –º–µ—Ç–æ–¥**. –û—Ç–ø—Ä–∞–≤–∫–∞ 3-—Ö ID –∫–∞—Ä—Ç. –°–µ—Ä–≤–µ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —ç—Ç–æ —Å–µ—Ç–æ–º.
*   `POST /set/add` ‚Äî –î–æ–±–∞–≤–∏—Ç—å 3 –∫–∞—Ä—Ç—ã –Ω–∞ —Å—Ç–æ–ª (–µ—Å–ª–∏ –∏–≥—Ä–æ–∫–∏ –∑–∞—à–ª–∏ –≤ —Ç—É–ø–∏–∫).
*   `POST /set/scores` ‚Äî –ü–æ–ª—É—á–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É –ª–∏–¥–µ—Ä–æ–≤ —Ç–µ–∫—É—â–µ–π –∫–æ–º–Ω–∞—Ç—ã.

## üìù –ü—Ä–∞–≤–∏–ª–∞ –∏–≥—Ä—ã (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤)

–í –∫–æ–ª–æ–¥–µ 81 –∫–∞—Ä—Ç–∞. –ö–∞–∂–¥–∞—è –∫–∞—Ä—Ç–∞ –∏–º–µ–µ—Ç 4 –ø—Ä–∏–∑–Ω–∞–∫–∞:
1.  **–¶–≤–µ—Ç** (1, 2, 3)
2.  **–§–æ—Ä–º–∞** (1, 2, 3)
3.  **–ó–∞–ª–∏–≤–∫–∞** (1, 2, 3)
4.  **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ** (1, 2, 3)

**–°–µ—Ç** ‚Äî —ç—Ç–æ –ª—é–±—ã–µ 3 –∫–∞—Ä—Ç—ã, —É –∫–æ—Ç–æ—Ä—ã—Ö –∫–∞–∂–¥—ã–π –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–∏–∑–Ω–∞–∫ –ª–∏–±–æ **–ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≤–ø–∞–¥–∞–µ—Ç** —É –≤—Å–µ—Ö —Ç—Ä–µ—Ö –∫–∞—Ä—Ç, –ª–∏–±–æ **–ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è** —É –≤—Å–µ—Ö —Ç—Ä–µ—Ö –∫–∞—Ä—Ç.
```